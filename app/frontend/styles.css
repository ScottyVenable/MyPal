/* Custom Fonts */
@font-face {
  font-family: 'Rounded Elegance';
  src: url('../media/fonts/header/Rounded Elegance Regular.otf') format('opentype');
  font-weight: normal;
  font-style: normal;
}

* { box-sizing: border-box; }
body { font-family: system-ui, Segoe UI, Arial; margin: 0; background: #0f1220; color: #e6e8f0; }

/* Custom Scrollbar Styles */
::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}

::-webkit-scrollbar-track {
  background: #0f1220;
  border-radius: 6px;
  border: 1px solid #1a2142;
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, #2a306b 0%, #3240a8 100%);
  border-radius: 6px;
  border: 2px solid #1a2142;
  transition: background 0.3s;
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, #3240a8 0%, #4250c8 100%);
}

::-webkit-scrollbar-thumb:active {
  background: linear-gradient(135deg, #4250c8 0%, #5260d8 100%);
}

::-webkit-scrollbar-corner {
  background: #0f1220;
}

/* Firefox scrollbar */
* {
  scrollbar-width: thin;
  scrollbar-color: #3240a8 #0f1220;
}

/* Profile Menu Styles */
.profile-menu {
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg, #0f1220 0%, #1a2142 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.profile-menu-content {
  max-width: 600px;
  width: 90%;
  text-align: center;
  padding: 2rem;
}

.profile-menu-logo {
  margin-bottom: 1.5rem;
  animation: fadeInDown 0.6s ease-out;
}

.profile-menu-logo img {
  width: 150px;
  height: auto;
  filter: drop-shadow(0 4px 12px rgba(154, 180, 255, 0.3));
}

@keyframes fadeInDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.profile-title {
  font-family: 'Rounded Elegance', system-ui, Segoe UI, Arial;
  font-size: 2.5rem;
  margin: 0 0 0.5rem;
  color: #dfe3ff;
  /* Temporarily disabled gradient text for debugging
  background: linear-gradient(135deg, #9ab4ff 0%, #dfe3ff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  */
}

.profile-subtitle {
  font-size: 1.1rem;
  color: #9ab4ff;
  margin: 0 0 2rem;
}

.continue-section {
  margin-bottom: 2rem;
}

.btn-large {
  font-size: 1.2rem;
  padding: 1rem 2rem;
}

.profile-actions {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin-bottom: 2rem;
}

.btn-primary, .btn-secondary {
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-primary {
  background: linear-gradient(135deg, #3240a8 0%, #4250c8 100%);
  color: white;
}

.btn-primary:hover {
  background: linear-gradient(135deg, #4250c8 0%, #5260d8 100%);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(50, 64, 168, 0.4);
}

.btn-secondary {
  background: #1f2452;
  color: #dfe3ff;
  border: 1px solid #2a306b;
}

.btn-secondary:hover {
  background: #2a306b;
  border-color: #3240a8;
}

.profile-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.profile-card {
  background: linear-gradient(135deg, #1a2142 0%, #151935 100%);
  border: 2px solid #2a306b;
  border-radius: 12px;
  padding: 1.5rem;
  text-align: left;
  transition: all 0.3s;
  cursor: pointer;
}

.profile-card:hover {
  border-color: #3240a8;
  transform: translateY(-4px);
  box-shadow: 0 8px 20px rgba(50, 64, 168, 0.3);
}

.profile-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.profile-card-name {
  font-size: 1.3rem;
  font-weight: 600;
  color: #dfe3ff;
  margin: 0;
}

.profile-card-delete {
  background: transparent;
  border: none;
  color: #ff6b6b;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  transition: all 0.2s;
}

.profile-card-delete:hover {
  background: rgba(255, 107, 107, 0.2);
}

.profile-card-stats {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.profile-stat {
  font-size: 0.9rem;
  color: #9ab4ff;
}

.profile-stat-value {
  font-weight: 600;
  color: #dfe3ff;
}

.profile-card-footer {
  font-size: 0.85rem;
  color: #6a7699;
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid #2a306b;
}

.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.modal-content {
  background: linear-gradient(135deg, #1a2142 0%, #151935 100%);
  border: 2px solid #3240a8;
  border-radius: 12px;
  padding: 2rem;
  max-width: 400px;
  width: 90%;
  pointer-events: auto;
}

.modal-content h2 {
  margin: 0 0 1rem;
  color: #dfe3ff;
}

.modal-content label {
  display: block;
  margin-bottom: 0.5rem;
  color: #9ab4ff;
  font-weight: 500;
}

.modal-content input {
  width: 100%;
  padding: 0.75rem;
  background: #0f1220;
  border: 1px solid #2a306b;
  border-radius: 6px;
  color: #dfe3ff;
  font-size: 1rem;
  margin-bottom: 0.5rem;
}

.modal-content input:focus {
  outline: none;
  border-color: #3240a8;
  box-shadow: 0 0 0 3px rgba(50, 64, 168, 0.2);
}

.form-hint {
  font-size: 0.85rem;
  color: #6a7699;
  margin-bottom: 1rem;
}

.form-error {
  color: #ff6b6b;
  font-size: 0.9rem;
  margin-bottom: 1rem;
  padding: 0.5rem;
  background: rgba(255, 107, 107, 0.1);
  border-radius: 4px;
}

.modal-actions {
  display: flex;
  gap: 0.75rem;
  justify-content: flex-end;
  margin-top: 1.5rem;
}

.hidden {
  display: none !important;
}

header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: #151935; border-bottom: 1px solid #252a52; gap: 16px; }
.header-left { display: flex; align-items: center; gap: 12px; }
.header-logo { width: 72px; height: 72px; object-fit: contain; filter: drop-shadow(0 2px 6px rgba(154, 180, 255, 0.3)); }
h1 { margin: 0; font-size: 20px; font-family: 'Rounded Elegance', system-ui, Segoe UI, Arial; }
.profile-badge { font-size: 14px; color: #9ab4ff; background: #1f2452; padding: 4px 12px; border-radius: 12px; border: 1px solid #2a306b; }
.exit-btn { padding: 8px 16px; background: #1f2452; color: #dfe3ff; border: 1px solid #2a306b; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; transition: all 0.2s; }
.exit-btn:hover { background: #2a306b; border-color: #3240a8; }
nav { display: flex; gap: 8px; }
nav button { padding: 8px 12px; background: #1f2452; color: #dfe3ff; border: 1px solid #2a306b; border-radius: 6px; cursor: pointer; }
nav button.active { background: #3240a8; }

main { 
  padding: 20px 24px; 
  max-width: 1920px;
  margin: 0 auto;
  height: calc(100vh - 120px);
  overflow-y: auto;
}

.tab { 
  display: none;
  height: 100%;
}

.tab.active { 
  display: flex;
  flex-direction: column;
}

.emotion-display {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  margin-bottom: 12px;
  background: linear-gradient(135deg, #1a2142 0%, #151935 100%);
  border: 1px solid #2a306b;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.emotion-icon {
  font-size: 40px;
  line-height: 1;
  animation: emotionPulse 2s ease-in-out infinite;
  user-select: none;
  min-width: 50px;
  text-align: center;
}

@keyframes emotionPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.emotion-details {
  flex: 1;
  min-width: 0;
}

.emotion-mood {
  font-size: 14px;
  color: #9ab4ff;
  margin-bottom: 6px;
  font-weight: 500;
}

.emotion-bar {
  height: 6px;
  background: #1f2452;
  border-radius: 3px;
  overflow: hidden;
  position: relative;
}

.emotion-fill {
  height: 100%;
  background: linear-gradient(90deg, #3240a8 0%, #5b6fd8 100%);
  border-radius: 3px;
  transition: width 0.5s ease-out, background 0.3s ease;
  box-shadow: 0 0 8px rgba(50, 64, 168, 0.6);
}

.emotion-fill.happy {
  background: linear-gradient(90deg, #ffc107 0%, #ff9800 100%);
  box-shadow: 0 0 8px rgba(255, 193, 7, 0.6);
}

.emotion-fill.curious {
  background: linear-gradient(90deg, #4caf50 0%, #66bb6a 100%);
  box-shadow: 0 0 8px rgba(76, 175, 80, 0.6);
}

.emotion-fill.caring {
  background: linear-gradient(90deg, #e91e63 0%, #f06292 100%);
  box-shadow: 0 0 8px rgba(233, 30, 99, 0.6);
}

.emotion-fill.concerned {
  background: linear-gradient(90deg, #9c27b0 0%, #ba68c8 100%);
  box-shadow: 0 0 8px rgba(156, 39, 176, 0.6);
}

.emotion-fill.friendly {
  background: linear-gradient(90deg, #00bcd4 0%, #4dd0e1 100%);
  box-shadow: 0 0 8px rgba(0, 188, 212, 0.6);
}

.emotion-fill.focused {
  background: linear-gradient(90deg, #3f51b5 0%, #5c6bc0 100%);
  box-shadow: 0 0 8px rgba(63, 81, 181, 0.6);
}

#chat-window {
  flex: 1;
  min-height: 400px;
  max-height: calc(100vh - 380px);
  overflow-y: auto;
  padding: 16px;
  background: #0a0f26;
  border: 1px solid #2a306b;
  border-radius: 8px;
}

.chat-layout {
  display: flex;
  gap: 24px;
  align-items: stretch;
  height: calc(100vh - 200px);
  max-height: 900px;
}

.chat-column {
  display: flex;
  flex-direction: column;
  gap: 16px;
  min-width: 0;
  height: 100%;
}

.chat-conversation {
  flex: 1 1 60%;
  display: flex;
  flex-direction: column;
}

.chat-insights {
  flex: 1 1 40%;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
}

.chat-insight-card {
  background: linear-gradient(135deg, #1a2142 0%, #11162e 100%);
  border: 1px solid #2a306b;
  border-radius: 14px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  min-height: 0;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.28);
}

.chat-insight-card--fill {
  flex: 1;
}

.insight-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 12px;
  flex-wrap: wrap;
}

.insight-title h2 {
  margin: 0;
  font-size: 18px;
}

.insight-subtitle {
  margin: 4px 0 0;
  font-size: 13px;
  color: #9ab4ff;
  opacity: 0.85;
}

.insight-link-btn {
  align-self: flex-start;
  padding: 6px 12px;
  border-radius: 8px;
  border: 1px solid #3240a8;
  background: rgba(50, 64, 168, 0.12);
  color: #b7c4ff;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.insight-link-btn:hover {
  background: rgba(50, 64, 168, 0.25);
  color: #dfe3ff;
  box-shadow: 0 2px 10px rgba(50, 64, 168, 0.3);
}

.insight-link-btn:focus-visible,
.insight-view-btn:focus-visible {
  outline: 2px solid rgba(154, 180, 255, 0.8);
  outline-offset: 2px;
}

.insight-body {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-height: 0;
}

.emotion-summary {
  font-size: 13px;
  color: #b7c4ff;
  background: rgba(31, 36, 82, 0.6);
  border: 1px solid rgba(50, 64, 168, 0.4);
  border-radius: 10px;
  padding: 12px;
  line-height: 1.5;
}

.insight-view-toggle {
  display: flex;
  gap: 8px;
  background: rgba(15, 19, 49, 0.9);
  border-radius: 12px;
  padding: 6px;
  border: 1px solid rgba(42, 48, 107, 0.8);
}

.insight-view-btn {
  flex: 1;
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid transparent;
  background: transparent;
  color: #9ab4ff;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.insight-view-btn:hover {
  background: rgba(50, 64, 168, 0.15);
  color: #dfe3ff;
}

.insight-view-btn.active {
  background: #3240a8;
  color: #ffffff;
  border-color: #4252d8;
  box-shadow: 0 2px 10px rgba(50, 64, 168, 0.35);
}

.insight-view {
  display: none;
  flex: 1;
  flex-direction: column;
  min-height: 0;
}

.insight-view.active {
  display: flex;
}

.insight-placeholder {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 20px;
  background: rgba(15, 19, 49, 0.82);
  border: 1px dashed rgba(90, 104, 200, 0.6);
  border-radius: 12px;
  color: #a9b6ff;
  font-size: 14px;
  line-height: 1.6;
}

@media (max-width: 1100px) {
  .chat-layout {
    flex-direction: column;
  }
  .chat-column {
    gap: 12px;
  }
  .chat-insight-card--fill {
    min-height: 260px;
  }
  .insight-view-toggle {
    width: 100%;
    flex-wrap: wrap;
  }
  .insight-view-btn {
    flex: 1 1 calc(50% - 6px);
  }
}

@media (max-width: 640px) {
  .chat-layout {
    gap: 16px;
  }
  .insight-view-btn {
    flex: 1 1 100%;
  }
}
.msg { display: flex; margin: 8px 0; align-items: center; gap: 8px; }
.msg .bubble { max-width: 70%; padding: 8px 12px; border-radius: 14px; }
.msg.user { justify-content: flex-end; }
.msg.user .bubble { background: #2a306b; }
.msg.pal .bubble { background: #20316b; }
.msg .meta { font-size: 11px; opacity: 0.7; margin-top: 2px; }

/* Typing indicator */
.msg.typing .bubble { background: #1b274f; display: inline-flex; align-items: center; gap: 4px; }
.typing-bubble .dot { width: 6px; height: 6px; border-radius: 50%; background: #9ab4ff; opacity: 0.6; display: inline-block; animation: blink 1.2s infinite ease-in-out; }
.typing-bubble .dot:nth-child(2) { animation-delay: 0.2s; }
.typing-bubble .dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes blink { 0%, 80%, 100% { opacity: 0.2; } 40% { opacity: 1; } }

.feedback-buttons {
  display: flex;
  gap: 4px;
  align-self: center;
}

.feedback-btn {
  background: rgba(42, 48, 107, 0.5);
  border: 1px solid #2a306b;
  border-radius: 50%;
  width: 28px;
  height: 28px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s ease;
  opacity: 0.6;
}

.feedback-btn:hover {
  opacity: 1;
  transform: scale(1.1);
}

.feedback-btn.active {
  opacity: 1;
  transform: scale(1.15);
}

.feedback-btn.thumbs-up.active {
  background: rgba(76, 175, 80, 0.3);
  border-color: #4caf50;
  box-shadow: 0 0 8px rgba(76, 175, 80, 0.4);
}

.feedback-btn.thumbs-down.active {
  background: rgba(244, 67, 54, 0.3);
  border-color: #f44336;
  box-shadow: 0 0 8px rgba(244, 67, 54, 0.4);
}

.msg.user .feedback-buttons {
  order: -1;
}

.reinforce {
	margin-left: 6px;
	align-self: center;
	background: #3240a8;
	border: 1px solid #2a306b;
	color: #ffd966;
	border-radius: 50%;
	width: 28px; height: 28px;
	display: inline-flex; align-items: center; justify-content: center;
	cursor: pointer;
}
.reinforce:disabled { opacity: 0.5; cursor: default; }

/* Try again button */
.try-again-btn {
  padding: 6px 10px;
  border-radius: 14px;
  border: 1px solid #2a306b;
  background: #1f2452;
  color: #dfe3ff;
  cursor: pointer;
  font-size: 12px;
}
.try-again-btn:hover { background: #28306f; }

/* Chat search tools */
.chat-tools { display: flex; gap: 8px; margin: 0 0 8px; flex-wrap: wrap; }
.chat-tools input { flex: 1; padding: 8px; border-radius: 8px; border: 1px solid #2a306b; background: #0f1331; color: #e6e8f0; }
.chat-tools button { padding: 8px 12px; border-radius: 8px; background: #20316b; color: #dfe3ff; border: 1px solid #2a306b; cursor: pointer; }
.search-results { background: #121634; border: 1px solid #2a306b; border-radius: 8px; margin-bottom: 8px; max-height: 200px; overflow-y: auto; }
.search-results.hidden { display: none; }
.search-row { display: grid; grid-template-columns: 120px 50px 1fr; gap: 8px; padding: 6px 10px; border-bottom: 1px solid #1f2452; font-size: 12px; color: #cfd5ff; }
.search-row .who { color: #ffdca8; }
.search-row:last-child { border-bottom: none; }

#chat-form { display: flex; gap: 8px; margin-top: 10px; }
#chat-input { flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #2a306b; background: #0f1331; color: #e6e8f0; }
#chat-form button { padding: 10px 16px; border-radius: 8px; background: #3240a8; color: white; border: none; cursor: pointer; }

.settings { margin-top: 12px; display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
.settings input { width: 80px; padding: 6px; border-radius: 6px; border: 1px solid #2a306b; background: #0f1331; color: #e6e8f0; }
.settings input[type="range"] { width: 160px; padding: 0; background: transparent; }
.settings input[type="range"]::-webkit-slider-thumb { background: #3240a8; }
.settings input[type="range"]::-moz-range-thumb { background: #3240a8; }
.settings .slider-group { flex-direction: column; align-items: flex-start; gap: 4px; }
.settings .slider-group span { font-size: 13px; color: #9ab4ff; }
.settings select { padding: 6px; border-radius: 6px; border: 1px solid #2a306b; background: #0f1331; color: #e6e8f0; }
.settings label { display: flex; align-items: center; gap: 6px; }
.settings label input[type="checkbox"] { width: auto; }
.settings button { padding: 8px 12px; border-radius: 6px; background: #20316b; color: #dfe3ff; border: 1px solid #2a306b; cursor: pointer; }
.settings .danger { background: #6b2034; }

.stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 16px; }
.stat-box { background: #121634; border: 1px solid #2a306b; border-radius: 8px; padding: 12px 8px; text-align: center; transition: all 0.2s; }
.stat-box:hover { border-color: #3a4a9f; background: #151935; transform: translateY(-2px); }

.pal-advancement-card {
  background: linear-gradient(135deg, #1a2142 0%, #151935 100%);
  border: 1px solid #2a306b;
  border-radius: 12px;
  padding: 16px 20px;
  margin-bottom: 16px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
}

.pal-advancement-card h3 {
  margin: 0 0 12px 0;
  font-size: 17px;
  color: #9ab4ff;
  text-align: center;
  font-weight: 600;
}

.advancement-content {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.advancement-info {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.advancement-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 12px;
  background: rgba(42, 48, 107, 0.3);
  border-radius: 8px;
}

.advancement-label {
  font-size: 13px;
  color: #9ab4ff;
  font-weight: 500;
}

.advancement-value {
  font-size: 15px;
  color: #e6e8f0;
  font-weight: 600;
}

.advancement-value.highlight {
  color: #ffd966;
  font-size: 16px;
}

.advancement-progress {
  margin-top: 6px;
}

.progress-bar-container {
  position: relative;
  height: 28px;
  background: #1f2452;
  border-radius: 14px;
  overflow: hidden;
  border: 2px solid #2a306b;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, #3240a8 0%, #5b6fd8 50%, #7b8ff8 100%);
  border-radius: 14px;
  transition: width 0.5s ease-out;
  box-shadow: 0 0 12px rgba(50, 64, 168, 0.6);
  position: relative;
  overflow: hidden;
}

.progress-bar-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.2) 50%, transparent 100%);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.progress-bar-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 14px;
  font-weight: 700;
  color: #ffffff;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  z-index: 10;
}

.current-emotion-card {
  background: #121634;
  border: 1px solid #2a306b;
  border-radius: 12px;
  padding: 14px 16px;
  margin-bottom: 16px;
}

.current-emotion-card h3 {
  margin: 0 0 12px 0;
  font-size: 15px;
  color: #9ab4ff;
  font-weight: 600;
}

.emotion-display-large {
  display: flex;
  align-items: center;
  gap: 16px;
}

.emotion-icon-large {
  font-size: 56px;
  line-height: 1;
  user-select: none;
  animation: emotionPulse 2s ease-in-out infinite;
  flex-shrink: 0;
}

.emotion-info {
  flex: 1;
  min-width: 0;
}

.emotion-label {
  font-size: 11px;
  color: #7a8ab8;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 3px;
  margin-top: 10px;
  font-weight: 600;
}

.emotion-label:first-child {
  margin-top: 0;
}

.emotion-value {
  font-size: 16px;
  color: #e6e8f0;
  font-weight: 600;
  margin-bottom: 6px;
}

.emotion-bar-large {
  height: 10px;
  background: #1f2452;
  border-radius: 5px;
  overflow: hidden;
  position: relative;
}

/* Progress dashboard */
.progress-dashboard { 
  display: grid; 
  grid-template-columns: repeat(2, minmax(0, 1fr)); 
  gap: 14px; 
  margin: 16px 0; 
}

@media (max-width: 1200px) {
  .progress-dashboard {
    grid-template-columns: 1fr;
  }
}

.chart-card { 
  background: #0a0f26; 
  border: 1px solid #2a306b; 
  border-radius: 12px; 
  padding: 16px; 
  min-height: 320px;
  max-height: 450px;
  display: flex;
  flex-direction: column;
}

.chart-card h3 { 
  margin: 0 0 12px 0; 
  font-size: 15px; 
  color: #9ab4ff; 
  font-weight: 600;
}

.chart-card canvas {
  flex: 1;
  min-height: 0;
  max-height: 400px;
}

.brain-placeholder { height: 400px; background: #121634; border: 1px dashed #2a306b; border-radius: 8px; display: flex; align-items: center; justify-content: center; opacity: 0.8; }

.graph-loading {
  height: 400px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 20px;
  color: #9ab4ff;
  font-size: 14px;
}

.loading-spinner {
  width: 48px;
  height: 48px;
  border: 4px solid rgba(154, 180, 255, 0.2);
  border-top-color: #3240a8;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.graph-loading p {
  margin: 0;
  font-weight: 500;
}

#brain-graph { height: 600px; background: #121634; border: 1px solid #2a306b; border-radius: 8px; }

.brain-toolbar { 
  display: flex; 
  gap: 12px; 
  margin-bottom: 12px; 
  align-items: center;
  padding: 12px;
  background: #151935;
  border: 1px solid #2a306b;
  border-radius: 8px;
  flex-wrap: wrap;
}

.brain-toolbar button { 
  padding: 8px 12px; 
  border-radius: 6px; 
  background: #3240a8; 
  color: white; 
  border: none; 
  cursor: pointer; 
  transition: all 0.2s;
}

.brain-toolbar button:hover { 
  background: #4858d8; 
}

.brain-search {
  display: flex;
  align-items: center;
  gap: 4px;
  background: #0d0f1a;
  border: 1px solid #2a306b;
  border-radius: 6px;
  padding: 4px 8px;
}

.brain-search input {
  background: transparent;
  border: none;
  color: #dfe3ff;
  font-size: 13px;
  padding: 4px;
  outline: none;
  width: 180px;
}

.brain-search input::placeholder {
  color: #5a6b8f;
}

#brain-search-clear {
  padding: 2px 6px;
  font-size: 12px;
  background: transparent;
  color: #7a8cb8;
  min-width: auto;
}

#brain-search-clear:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #dfe3ff;
}

.brain-filter-controls {
  display: flex;
  align-items: center;
  gap: 12px;
}

.brain-filter-controls .filter-label {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
  color: #a8b2d1;
}

.brain-filter-controls input[type="range"] {
  width: 80px;
  cursor: pointer;
}

.brain-filter-controls select {
  background: #0d0f1a;
  border: 1px solid #2a306b;
  border-radius: 6px;
  color: #dfe3ff;
  padding: 6px 10px;
  font-size: 13px;
  cursor: pointer;
  outline: none;
}

.brain-filter-controls select:hover {
  border-color: #3240a8;
}

#filter-freq-value {
  min-width: 20px;
  text-align: center;
  color: #dfe3ff;
  font-weight: 600;
}

.brain-toolbar span { 
  margin-left: auto; 
  font-size: 13px; 
  color: #9ab4ff; 
  align-self: center; 
  font-weight: 500; 
}

.brain-layout { 
  display: grid; 
  grid-template-columns: minmax(0, 7fr) minmax(320px, 3fr); 
  gap: 16px;
  height: calc(100vh - 280px);
  max-height: 700px;
}

.brain-graph-card { 
  background: #0a0f26; 
  border: 1px solid #2a306b; 
  border-radius: 10px; 
  padding: 16px;
  height: 100%;
  overflow: hidden;
}

.brain-sidebar { 
  display: flex; 
  flex-direction: column; 
  gap: 12px;
  height: 100%;
  overflow-y: auto;
}
.brain-info, .brain-memories { background: #121634; border: 1px solid #2a306b; border-radius: 10px; padding: 14px; }
.brain-info h3, .brain-memories h3 { margin: 0 0 10px 0; font-size: 15px; color: #dfe3ff; font-weight: 600; }
.brain-info .collapsible-header { display: flex; justify-content: space-between; align-items: center; cursor: pointer; user-select: none; }
.brain-info .collapsible-header:hover { color: #9ab4ff; }
.brain-info .collapse-btn { background: transparent; border: none; color: #9ab4ff; font-size: 18px; cursor: pointer; padding: 0; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.2s; }
.brain-info .collapse-btn:hover { background: rgba(154, 180, 255, 0.1); }
.brain-info .collapsible-content { overflow: hidden; transition: max-height 0.3s ease-out, opacity 0.3s ease-out; }
.brain-info .collapsible-content.collapsed { max-height: 0; opacity: 0; margin: 0; }
.brain-info p { margin: 0 0 8px 0; color: #cfd5ff; font-size: 12px; line-height: 1.5; }
.brain-info ul { margin: 6px 0 0 0; padding-left: 18px; color: #aeb6ea; font-size: 12px; line-height: 1.6; }
.brain-info ul li { margin-bottom: 4px; }
.brain-memories-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.memory-search { margin-bottom: 10px; }
.memory-search input { width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid #2a306b; background: #0f1331; color: #dfe3ff; font-size: 12px; transition: all 0.2s; }
.memory-search input:focus { outline: none; border-color: #3a4a9f; background: #121634; }
.memory-search input::placeholder { color: #7080b3; }
.memory-list { display: flex; flex-direction: column; gap: 8px; max-height: 450px; overflow-y: auto; }
.memory-item { padding: 12px; border-radius: 8px; background: #0f1331; border: 1px solid #2a306b; transition: all 0.2s; }
.memory-item:hover { border-color: #3a4a9f; background: #121634; }
.memory-item header { display: flex; justify-content: space-between; font-size: 11px; color: #9ab4ff; margin-bottom: 8px; font-weight: 500; }
.memory-item .text { font-size: 13px; color: #dfe3ff; margin-bottom: 8px; line-height: 1.5; white-space: pre-line; }
.memory-item .subjective-narrative { 
  margin: 8px 0; 
  padding: 12px; 
  background: linear-gradient(135deg, rgba(50, 64, 168, 0.15) 0%, rgba(26, 33, 66, 0.2) 100%);
  border-left: 3px solid #5b6fd8;
  border-radius: 6px;
}
.memory-item .narrative-label {
  display: block;
  font-size: 11px;
  color: #9ab4ff;
  font-weight: 600;
  margin-bottom: 6px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.memory-item .subjective-narrative p {
  margin: 0;
  font-size: 13px;
  color: #cfd5ff;
  line-height: 1.6;
  font-style: italic;
}
.memory-item .keywords { font-size: 11px; color: #98a0d3; }
.memory-item .sentiment-positive { color: #7cd67c; }
.memory-item .sentiment-negative { color: #ff7d7d; }
.memory-item .sentiment-neutral { color: #d4c86b; }
.memory-empty, .graph-empty { font-size: 13px; color: #98a0d3; text-align: center; padding: 20px 0; }

@media (max-width: 960px) {
	.brain-layout { grid-template-columns: 1fr; }
}

footer { padding: 12px 16px; border-top: 1px solid #252a52; color: #98a0d3; }

.journal-toolbar { display: flex; gap: 8px; margin-bottom: 10px; align-items: center; }
.journal-toolbar button { padding: 8px 12px; border-radius: 6px; background: #20316b; color: #dfe3ff; border: 1px solid #2a306b; cursor: pointer; }
.journal-toolbar span { margin-left: auto; font-size: 13px; color: #9ab4ff; }
.journal-list { display: flex; flex-direction: column; gap: 12px; max-height: 70vh; overflow-y: auto; }
.journal-entry { background: #121634; border: 1px solid #2a306b; border-radius: 10px; padding: 12px; }
.journal-entry header { display: flex; justify-content: space-between; font-size: 12px; color: #9ab4ff; margin-bottom: 6px; }
.journal-entry .journal-user { font-size: 13px; color: #dfe3ff; margin: 0 0 6px 0; }
.journal-entry .journal-focus { font-size: 12px; color: #cfd5ff; margin: 0 0 6px 0; }
.journal-entry .journal-analysis { font-size: 11px; color: #98a0d3; margin: 0 0 8px 0; display: flex; flex-wrap: wrap; gap: 8px; }
.journal-entry .journal-analysis span { background: rgba(50,64,168,0.25); border: 1px solid #2a306b; border-radius: 12px; padding: 2px 8px; }
.journal-entry .journal-reasoning { margin: 0 0 6px 0; padding-left: 18px; color: #aeb6ea; font-size: 12px; }
.journal-entry .journal-response { font-size: 13px; color: #ffdca8; margin: 0 0 6px 0; }
.journal-entry .journal-memory { font-size: 12px; color: #98a0d3; margin: 0; display: flex; gap: 12px; flex-wrap: wrap; }

/* Enhanced Neural Visualization Styles */
.neural-container {
  display: grid;
  grid-template-columns: minmax(0, 7fr) minmax(320px, 3fr);
  gap: 16px;
  height: calc(100vh - 280px);
  max-height: 700px;
}

.neural-visualization {
  background: #0a0f26;
  border: 1px solid #2a306b;
  border-radius: 12px;
  padding: 16px;
  height: 100%;
  overflow: hidden;
}

#neural-canvas {
  width: 100%;
  height: 100%;
  background: radial-gradient(ellipse at center, #0f1331 0%, #0a0f26 70%);
  border-radius: 8px;
}

.neural-sidebar {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.neural-info, .neural-stats, .neural-events, .region-details {
  background: #121634;
  border: 1px solid #2a306b;
  border-radius: 10px;
  padding: 14px;
}

.neural-info h3, .neural-stats h4, .neural-events h4 {
  margin: 0 0 12px 0;
  font-size: 15px;
  color: #dfe3ff;
  font-weight: 600;
}

.region-legend {
  margin-top: 12px;
}

.region-legend h4 {
  margin: 0 0 8px 0;
  font-size: 13px;
  color: #cfd5ff;
  font-weight: 600;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
  font-size: 12px;
  color: #aeb6ea;
}

.legend-color {
  width: 12px;
  height: 12px;
  border-radius: 2px;
  flex-shrink: 0;
}

.stat-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  font-size: 12px;
}

.stat-row span:first-child {
  color: #cfd5ff;
}

.stat-row span:last-child {
  color: #9ab4ff;
  font-weight: 600;
}

.neural-action-btn, .region-trigger-btn, .neuron-trigger-btn {
  width: 100%;
  padding: 10px;
  margin-top: 12px;
  background: linear-gradient(135deg, #5b6fd8 0%, #3a4a9f 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.neural-action-btn:hover, .region-trigger-btn:hover, .neuron-trigger-btn:hover {
  background: linear-gradient(135deg, #6b7fe8 0%, #4a5aaf 100%);
  transform: translateY(-1px);
}

.event-list {
  max-height: 200px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.event-item {
  background: #0f1331;
  border: 1px solid #2a306b;
  border-radius: 6px;
  padding: 8px 10px;
  font-size: 11px;
}

.event-item.firing {
  border-left: 3px solid #66bb6a;
}

.event-time {
  color: #7080b3;
  font-size: 10px;
  margin-top: 2px;
}

/* SVG Neural Network Styles */
.region-group .region-background {
  transition: all 0.3s ease;
}

.region-group:hover .region-background {
  opacity: 0.25 !important;
  stroke-opacity: 0.5 !important;
}

.region-group.selected .region-background {
  opacity: 0.3 !important;
  stroke-width: 3 !important;
  stroke-opacity: 0.8 !important;
}

.region-label {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 12px;
  font-weight: 600;
  fill: #dfe3ff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.neuron-node {
  transition: all 0.2s ease;
  cursor: pointer;
}

.neuron-excitatory {
  filter: drop-shadow(0 0 2px rgba(100, 181, 246, 0.3));
}

.neuron-inhibitory {
  filter: drop-shadow(0 0 1px rgba(156, 39, 176, 0.3));
}

.inter-region-connection {
  transition: all 0.3s ease;
}

.region-group:hover .inter-region-connection {
  stroke-opacity: 0.6 !important;
}

/* Neuron Details Modal */
.neuron-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1001;
  animation: fadeIn 0.2s ease-out;
}

.neuron-modal-content {
  background: #121634;
  border: 1px solid #2a306b;
  border-radius: 12px;
  width: 90%;
  max-width: 480px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.neuron-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  border-bottom: 1px solid #2a306b;
}

.neuron-modal-header h3 {
  margin: 0;
  font-size: 16px;
  color: #dfe3ff;
  font-weight: 600;
}

.neuron-modal-close {
  background: none;
  border: none;
  color: #9ab4ff;
  font-size: 24px;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.neuron-modal-close:hover {
  background: rgba(154, 180, 255, 0.1);
}

.neuron-modal-body {
  padding: 20px;
}

.neuron-detail-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 12px;
  font-size: 13px;
}

.neuron-detail-row strong {
  color: #cfd5ff;
  font-weight: 600;
}

.neuron-detail-row:not(strong) {
  color: #9ab4ff;
}

.neuron-actions {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid #2a306b;
}

.region-detail-card {
  background: #0f1331;
  border: 1px solid #2a306b;
  border-radius: 8px;
  padding: 12px;
  margin-top: 8px;
}

.region-detail-card h5 {
  margin: 0 0 10px 0;
  font-size: 14px;
  font-weight: 600;
}

.region-stat {
  display: flex;
  justify-content: space-between;
  margin-bottom: 6px;
  font-size: 12px;
  color: #cfd5ff;
}

.region-actions {
  margin-top: 12px;
}

/* Trigger Feedback Animation */
@keyframes fadeInOut {
  0% { 
    opacity: 0; 
    transform: translateY(-20px); 
  }
  20%, 80% { 
    opacity: 1; 
    transform: translateY(0); 
  }
  100% { 
    opacity: 0; 
    transform: translateY(-10px); 
  }
}

@keyframes fadeIn {
  from { 
    opacity: 0; 
    transform: scale(0.95); 
  }
  to { 
    opacity: 1; 
    transform: scale(1); 
  }
}

/* Neural Growth Animations */
@keyframes growthCelebration {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  20% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.1);
  }
  30% {
    transform: translate(-50%, -50%) scale(1);
  }
  85% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.9);
  }
}

@keyframes neuralGrowthPulse {
  0% {
    opacity: 0.15;
    stroke-width: 2;
  }
  50% {
    opacity: 0.4;
    stroke-width: 4;
    filter: drop-shadow(0 0 10px currentColor);
  }
  100% {
    opacity: 0.15;
    stroke-width: 2;
  }
}

.neural-growth-celebration .growth-icon {
  font-size: 32px;
  animation: bounce 1s ease-in-out infinite;
}

.neural-growth-celebration .growth-title {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 4px;
}

.neural-growth-celebration .growth-details {
  font-size: 14px;
  opacity: 0.9;
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-10px);
  }
  60% {
    transform: translateY(-5px);
  }
}

/* Responsive Neural Layout */
@media (max-width: 1200px) {
  .neural-container {
    grid-template-columns: 1fr;
    height: auto;
  }
  
  .neural-visualization {
    height: 500px;
  }
  
  .neural-sidebar {
    flex-direction: row;
    flex-wrap: wrap;
  }
  
  .neural-info, .neural-stats, .neural-events {
    flex: 1;
    min-width: 200px;
  }
}

@media (max-width: 768px) {
  .neural-sidebar {
    flex-direction: column;
  }
}

/* Modal */
.modal { position: fixed; inset: 0; background: rgba(0,0,0,0.55); display: flex; align-items: center; justify-content: center; z-index: 1000; }
.modal.hidden { display: none; }
.modal-card { width: min(560px, 92vw); background: #151935; border: 1px solid #2a306b; border-radius: 12px; padding: 16px; box-shadow: 0 10px 28px rgba(0,0,0,0.4); }
.modal-card h2 { margin: 0 0 6px 0; }
.modal-card p { margin: 0 0 12px 0; color: #cfd5ff; }
.modal-actions { display: flex; gap: 8px; justify-content: flex-end; }
.modal-actions button { padding: 8px 12px; border-radius: 6px; background: #20316b; color: #dfe3ff; border: 1px solid #2a306b; cursor: pointer; }

/* Settings Tab */
.settings-container { max-width: 720px; margin: 0 auto; }
.settings-container h2 { margin: 0 0 20px 0; color: #dfe3ff; }
.settings-section { background: #121634; border: 1px solid #2a306b; border-radius: 10px; padding: 20px; margin-bottom: 16px; }
.settings-section h3 { margin: 0 0 16px 0; font-size: 16px; color: #9ab4ff; }
.settings-section label { display: flex; flex-direction: column; gap: 6px; margin-bottom: 12px; }
.settings-section label span { font-size: 13px; color: #cfd5ff; }
.settings-section input, .settings-section select { padding: 8px; border-radius: 6px; border: 1px solid #2a306b; background: #0f1331; color: #e6e8f0; }
.settings-section input[type="range"] { background: transparent; }
.settings-section input[type="range"]::-webkit-slider-thumb { background: #3240a8; }
.settings-section input[type="range"]::-moz-range-thumb { background: #3240a8; }
.settings-section .slider-group { display: flex; flex-direction: row; align-items: center; gap: 12px; }
.settings-section .slider-group span:first-child { flex: 0 0 auto; }
.settings-section .slider-group input { flex: 1; }
.settings-section .slider-group span:last-child { flex: 0 0 auto; min-width: 40px; text-align: right; color: #9ab4ff; font-weight: 500; }
.settings-section .checkbox-label { flex-direction: row; align-items: center; gap: 8px; }
.settings-section .checkbox-label input { width: auto; }
.settings-section .help-text { font-size: 12px; color: #98a0d3; margin: 8px 0 0 0; }
.settings-section .danger-text { color: #ff9999; }
.settings-actions { display: flex; gap: 10px; flex-wrap: wrap; }
.settings-actions button { padding: 10px 16px; border-radius: 8px; border: 1px solid #2a306b; cursor: pointer; }
.settings-actions button.primary { background: #3240a8; color: white; border: none; }
.settings-actions button:not(.primary):not(.danger) { background: #20316b; color: #dfe3ff; }
.settings-actions button.danger { background: #6b2034; color: #ffb3b3; border-color: #8b3050; }

/* About Section */
.about-section {
  text-align: center;
  border: 2px solid #3240a8;
  background: linear-gradient(135deg, #0f1220 0%, #151935 100%);
}

.about-logo {
  margin-bottom: 1rem;
}

.about-logo img {
  width: 120px;
  height: auto;
  filter: drop-shadow(0 4px 8px rgba(154, 180, 255, 0.3));
}

.about-section h3 {
  color: #dfe3ff;
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
}

.about-text {
  color: #9ab4ff;
  font-size: 1rem;
  margin: 0.5rem 0;
}

.about-version {
  color: #cfd5ff;
  font-size: 0.9rem;
  margin: 0.5rem 0;
  font-weight: 600;
}

.about-copyright {
  color: #7080b3;
  font-size: 0.85rem;
  margin: 0.5rem 0;
}

/* Dev panel */
.dev-panel { position: fixed; bottom: 12px; right: 12px; background: #0f1331; border: 1px solid #2a306b; border-radius: 8px; padding: 10px; color: #cfd5ff; min-width: 220px; z-index: 999; }
.dev-panel.hidden { display: none; }
.dev-panel .dev-row { margin: 4px 0; font-size: 13px; }
.dev-panel button { padding: 6px 10px; border-radius: 6px; background: #20316b; color: #dfe3ff; border: 1px solid #2a306b; cursor: pointer; }
.dev-panel input { padding: 6px; border-radius: 6px; border: 1px solid #2a306b; background: #0f1331; color: #e6e8f0; }

/* Disabled states for buttons and inputs */
button:disabled, input:disabled {
  opacity: 0.5;
  cursor: not-allowed !important;
  pointer-events: none;
}

button:disabled {
  background: #1a1f3a !important;
}

/* Loading animations for buttons */
button:disabled::after {
  content: '';
  display: inline-block;
  width: 12px;
  height: 12px;
  margin-left: 8px;
  border: 2px solid transparent;
  border-top-color: currentColor;
  border-radius: 50%;
  animation: buttonSpin 0.6s linear infinite;
}

@keyframes buttonSpin {
  to { transform: rotate(360deg); }
}

/* Help icons */
.help-icon {
  display: inline-block;
  width: 18px;
  height: 18px;
  line-height: 18px;
  text-align: center;
  border-radius: 50%;
  background: rgba(154, 180, 255, 0.2);
  color: #9ab4ff;
  font-size: 12px;
  font-weight: bold;
  cursor: help;
  margin-left: 6px;
  transition: all 0.2s ease;
}

.help-icon:hover {
  background: rgba(154, 180, 255, 0.3);
  transform: scale(1.1);
  box-shadow: 0 0 8px rgba(154, 180, 255, 0.4);
}

/* Brain Tab Sub-Tabs */
.brain-tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 1px solid #2a306b;
}

.brain-tab-btn {
  padding: 8px 16px;
  background: #1f2452;
  color: #dfe3ff;
  border: 1px solid #2a306b;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.brain-tab-btn:hover {
  background: #252a6b;
}

.brain-tab-btn.active {
  background: #3240a8;
  border-color: #4858d8;
}

.brain-tab-content {
  display: none;
}

.brain-tab-content.active {
  display: block;
}

/* Neural Visualization */
.neural-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding: 12px;
  background: #151935;
  border: 1px solid #2a306b;
  border-radius: 8px;
  flex-wrap: wrap;
}

.neural-toolbar button {
  padding: 8px 12px;
  background: #3240a8;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s ease;
}

.neural-toolbar button:hover {
  background: #4858d8;
}

.neural-search {
  display: flex;
  align-items: center;
  gap: 4px;
  background: #0d0f1a;
  border: 1px solid #2a306b;
  border-radius: 6px;
  padding: 4px 8px;
}

.neural-search input {
  background: transparent;
  border: none;
  color: #dfe3ff;
  font-size: 13px;
  padding: 4px;
  outline: none;
  width: 180px;
}

.neural-search input::placeholder {
  color: #5a6b8f;
}

#neural-search-clear {
  padding: 2px 6px;
  font-size: 12px;
  background: transparent;
  color: #7a8cb8;
  min-width: auto;
}

#neural-search-clear:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #dfe3ff;
}

.neural-filter-controls {
  display: flex;
  align-items: center;
  gap: 12px;
}

.filter-label {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
  color: #a8b2d1;
  cursor: pointer;
  user-select: none;
}

.filter-label input[type="checkbox"] {
  cursor: pointer;
}

.neural-filter-controls select {
  background: #0d0f1a;
  border: 1px solid #2a306b;
  border-radius: 6px;
  color: #dfe3ff;
  padding: 6px 10px;
  font-size: 13px;
  cursor: pointer;
  outline: none;
}

.neural-filter-controls select:hover {
  border-color: #3240a8;
}

.neural-container {
  display: flex;
  gap: 16px;
  height: 600px;
}

.neural-visualization {
  flex: 1;
  background: #0d0f1a;
  border: 1px solid #2a306b;
  border-radius: 8px;
  padding: 16px;
  overflow: hidden;
}

#neural-canvas {
  width: 100%;
  height: 100%;
}

.neural-sidebar {
  width: 300px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  overflow-y: auto;
}

.neural-info,
.neural-stats,
.neural-events {
  background: #151935;
  border: 1px solid #2a306b;
  border-radius: 8px;
  padding: 12px;
}

.neural-info h3,
.neural-stats h4,
.neural-events h4 {
  margin: 0 0 12px 0;
  color: #9ab4ff;
  font-size: 14px;
  font-weight: 600;
}

.neural-info p {
  margin: 0 0 12px 0;
  font-size: 13px;
  color: #a8b2d1;
  line-height: 1.5;
}

.region-legend {
  margin-top: 12px;
}

.region-legend h4 {
  margin: 0 0 8px 0;
  font-size: 12px;
  color: #7a8cb8;
  text-transform: uppercase;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
  font-size: 12px;
}

.legend-color {
  width: 14px;
  height: 14px;
  border-radius: 3px;
  flex-shrink: 0;
}

.stat-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  font-size: 13px;
}

.stat-row span:first-child {
  color: #7a8cb8;
}

.stat-row span:last-child {
  color: #ffffff;
  font-weight: 500;
}

.event-list {
  max-height: 200px;
  overflow-y: auto;
  font-size: 12px;
}

.event-item {
  padding: 6px 8px;
  margin-bottom: 4px;
  background: rgba(154, 180, 255, 0.05);
  border-left: 3px solid #3240a8;
  border-radius: 4px;
  font-size: 11px;
  color: #a8b2d1;
}

.event-item.firing {
  border-left-color: #66bb6a;
}

.event-item .event-time {
  color: #7a8cb8;
  font-size: 10px;
}

/* SVG Neuron Styles */
.neuron-node {
  cursor: pointer;
  transition: all 0.2s ease;
}

.neuron-node.firing {
  animation: neuronPulse 0.5s ease-out;
}

@keyframes neuronPulse {
  0% { r: 3; }
  50% { r: 6; }
  100% { r: 3; }
}

.region-group {
  opacity: 0.3;
  transition: opacity 0.3s ease;
}

.region-group.active {
  opacity: 1;
}

.region-label {
  font-size: 12px;
  fill: #9ab4ff;
  user-select: none;
}

/* Neural Action Button */
.neural-action-btn {
  width: 100%;
  margin-top: 16px;
  padding: 12px;
  background: linear-gradient(135deg, #3240a8 0%, #5b6fd8 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(50, 64, 168, 0.3);
}

.neural-action-btn:hover {
  background: linear-gradient(135deg, #4350c0 0%, #6b7fe0 100%);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(50, 64, 168, 0.4);
}

.neural-action-btn:active {
  transform: translateY(0);
  box-shadow: 0 2px 8px rgba(50, 64, 168, 0.3);
}

/* Neural Regeneration Modal */
.neural-regen-card {
  min-width: 500px;
  max-width: 600px;
}

.neural-regen-subtitle {
  color: #7a8cb8;
  font-size: 14px;
  margin: -8px 0 20px 0;
  font-style: italic;
}

.progress-container {
  margin: 20px 0;
}

.progress-bar {
  position: relative;
  width: 100%;
  height: 32px;
  background: #1f2452;
  border-radius: 16px;
  overflow: hidden;
  border: 1px solid #2a306b;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
}

.progress-fill {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  background: linear-gradient(90deg, #3240a8 0%, #5b6fd8 50%, #66bb6a 100%);
  border-radius: 16px;
  transition: width 0.3s ease;
  box-shadow: 0 0 16px rgba(50, 64, 168, 0.6);
  animation: progressGlow 2s ease-in-out infinite;
}

@keyframes progressGlow {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.85; }
}

.progress-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 14px;
  font-weight: 600;
  color: white;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  z-index: 1;
}

.neural-regen-status {
  margin: 20px 0;
  padding: 16px;
  background: rgba(154, 180, 255, 0.05);
  border-radius: 8px;
  border: 1px solid #2a306b;
}

.status-message {
  font-size: 14px;
  color: #e6e8f0;
  margin-bottom: 8px;
  font-weight: 500;
}

.status-eta {
  font-size: 12px;
  color: #7a8cb8;
  font-style: italic;
}

.neural-regen-phase {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  background: rgba(50, 64, 168, 0.1);
  border-radius: 6px;
  margin-bottom: 20px;
}

.phase-label {
  font-size: 12px;
  color: #7a8cb8;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 600;
}

.phase-value {
  font-size: 13px;
  color: #9ab4ff;
  font-weight: 500;
  animation: phaseFlash 1.5s ease-in-out infinite;
}

@keyframes phaseFlash {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* Floating Chat Modal */
.floating-chat-modal {
  position: fixed;
  top: 80px;
  right: 20px;
  width: 400px;
  max-width: calc(100vw - 40px);
  height: 550px;
  max-height: calc(100vh - 140px);
  background: linear-gradient(135deg, #151935 0%, #1a2142 100%);
  border: 2px solid #3240a8;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 20px rgba(50, 64, 168, 0.3);
  z-index: 9999;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  transition: box-shadow 0.2s ease;
  will-change: transform;
  transform: translate(0, 0);
}

.floating-chat-modal.dragging {
  box-shadow: 0 12px 48px rgba(0, 0, 0, 0.7), 0 0 30px rgba(50, 64, 168, 0.5);
  transition: none;
  pointer-events: none;
}

.floating-chat-modal.dragging > * {
  pointer-events: auto;
}

.floating-chat-modal.hidden {
  display: none;
}

.floating-chat-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: linear-gradient(90deg, #3240a8 0%, #4858d8 100%);
  border-bottom: 1px solid #5b6fd8;
  cursor: move;
  user-select: none;
  touch-action: none;
}

.floating-chat-header:active {
  cursor: grabbing;
}

.floating-chat-title {
  font-size: 15px;
  font-weight: 600;
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

#close-floating-chat {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  border: none;
  background: rgba(255, 255, 255, 0.2);
  color: white;
  font-size: 18px;
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

#close-floating-chat:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: rotate(90deg);
}

.floating-chat-body {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  padding: 12px;
}

.emotion-display-mini {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  margin-bottom: 10px;
  background: rgba(42, 48, 107, 0.3);
  border: 1px solid #2a306b;
  border-radius: 8px;
}

.emotion-icon-mini {
  font-size: 24px;
  line-height: 1;
  animation: emotionPulse 2s ease-in-out infinite;
  user-select: none;
}

.emotion-mood-mini {
  font-size: 12px;
  color: #9ab4ff;
  font-weight: 500;
  flex: 1;
}

#floating-chat-window {
  flex: 1;
  overflow-y: auto;
  padding: 8px;
  background: #0d0f1a;
  border: 1px solid #2a306b;
  border-radius: 8px;
  margin-bottom: 10px;
}

#floating-chat-form {
  display: flex;
  gap: 8px;
}

#floating-chat-input {
  flex: 1;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #2a306b;
  background: #0f1331;
  color: #e6e8f0;
  font-size: 13px;
}

#floating-chat-form button {
  padding: 10px 16px;
  border-radius: 8px;
  background: #3240a8;
  color: white;
  border: none;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s ease;
}

#floating-chat-form button:hover {
  background: #4858d8;
}

#floating-chat-form button:active {
  transform: scale(0.95);
}

/* Pop Out Button in Chat Tools */
#popout-chat-btn {
  background: #3240a8;
  transition: all 0.2s ease;
}

#popout-chat-btn:hover {
  background: #4858d8;
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(50, 64, 168, 0.4);
}

/* Theme Color Schemes */
body[data-theme="dark"] {
  --bg-primary: #0f1220;
  --bg-secondary: #151935;
  --bg-tertiary: #1a2142;
  --accent-primary: #3240a8;
  --accent-secondary: #9ab4ff;
  --text-primary: #e6e8f0;
  --text-secondary: #dfe3ff;
  --border-color: #2a306b;
}

body[data-theme="midnight"] {
  --bg-primary: #0a0e1a;
  --bg-secondary: #0f1428;
  --bg-tertiary: #141b35;
  --accent-primary: #2d3d8f;
  --accent-secondary: #7a8fe0;
  --text-primary: #d5daf0;
  --text-secondary: #c5cde8;
  --border-color: #1f2a5a;
}

body[data-theme="ocean"] {
  --bg-primary: #0a1520;
  --bg-secondary: #0f1f30;
  --bg-tertiary: #143040;
  --accent-primary: #1e6ba8;
  --accent-secondary: #5fa3d8;
  --text-primary: #d5e5f0;
  --text-secondary: #c5dde8;
  --border-color: #1a3a5a;
}

body[data-theme="forest"] {
  --bg-primary: #0f1510;
  --bg-secondary: #141f15;
  --bg-tertiary: #1a2a1c;
  --accent-primary: #2d7a3d;
  --accent-secondary: #6fb080;
  --text-primary: #d5f0dc;
  --text-secondary: #c5e8cf;
  --border-color: #1f3a25;
}

body[data-theme="sunset"] {
  --bg-primary: #1a0f0f;
  --bg-secondary: #251515;
  --bg-tertiary: #301a1a;
  --accent-primary: #8f3d2d;
  --accent-secondary: #d88070;
  --text-primary: #f0d5d5;
  --text-secondary: #e8c5c5;
  --border-color: #4a1f1f;
}

/* Smooth scrolling */
body.smooth-scrolling {
  scroll-behavior: smooth;
}

body.smooth-scrolling * {
  scroll-behavior: smooth;
}

/* Reduced motion */
body.reduced-motion *,
body.reduced-motion *::before,
body.reduced-motion *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
}

/* ====================================
   16:9 Display Optimizations
   ==================================== */

/* Optimize for common 16:9 resolutions */
@media (min-width: 1920px) and (min-height: 1080px) {
  main {
    padding: 24px 32px;
  }
  
  .chat-layout {
    max-height: 1000px;
  }
  
  #chat-window {
    max-height: calc(100vh - 320px);
  }
  
  .brain-layout,
  .neural-container {
    max-height: 850px;
  }
  
  .chart-card {
    max-height: 520px;
  }
}

@media (min-width: 1600px) and (min-height: 900px) {
  .brain-layout,
  .neural-container {
    max-height: 750px;
  }
  
  #chat-window {
    max-height: calc(100vh - 350px);
  }
}

@media (min-width: 1366px) and (min-height: 768px) {
  .brain-layout,
  .neural-container {
    max-height: 650px;
  }
  
  .chart-card {
    max-height: 380px;
  }
}

/* Ultrawide support (21:9, 32:9) */
@media (min-aspect-ratio: 21/9) {
  .chat-layout {
    grid-template-columns: minmax(0, 1.2fr) minmax(0, 0.8fr);
  }
  
  .brain-layout,
  .neural-container {
    grid-template-columns: minmax(0, 8fr) minmax(320px, 2fr);
  }
}

/* Compact vertical displays */
@media (max-height: 800px) {
  header {
    padding: 12px 16px;
  }
  
  main {
    padding: 12px 16px;
    height: calc(100vh - 100px);
  }
  
  .brain-layout,
  .neural-container {
    max-height: 550px;
  }
  
  #chat-window {
    max-height: calc(100vh - 300px);
  }
  
  .chart-card {
    max-height: 320px;
  }
}
